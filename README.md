
# –û–≥–ª–∞–≤–ª–µ–Ω–∏–µ

- [–û–ø–∏—Å–∞–Ω–∏–µ —Å–µ—Ä–≤–∏—Å–∞](#–æ–ø–∏—Å–∞–Ω–∏–µ-—Å–µ—Ä–≤–∏—Å–∞)
- [–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã](#–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞-–∏-–∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã)
  - [–û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã](#–æ—Å–Ω–æ–≤–Ω—ã–µ-–∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã)
  - [–û—Å–Ω–æ–≤–Ω—ã–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –¥–∞–Ω–Ω—ã—Ö](#–æ—Å–Ω–æ–≤–Ω—ã–µ-—Å—Ç—Ä—É–∫—Ç—É—Ä—ã-–¥–∞–Ω–Ω—ã—Ö)
  - [–ú–µ—Ç–æ–¥—ã –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏](#–º–µ—Ç–æ–¥—ã-–∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏)
  - [–û—Å–Ω–æ–≤–Ω—ã–µ –º–µ—Ç–æ–¥—ã](#–æ—Å–Ω–æ–≤–Ω—ã–µ-–º–µ—Ç–æ–¥—ã)
  - [–†–∞–±–æ—Ç–∞ —Å JSON –¥–∞–Ω–Ω—ã–º–∏](#—Ä–∞–±–æ—Ç–∞-—Å-json-–¥–∞–Ω–Ω—ã–º–∏)
  - [–†–∞–±–æ—Ç–∞ —Å –ª–æ–≥–≥–µ—Ä–æ–º](#—Ä–∞–±–æ—Ç–∞-—Å-–ª–æ–≥–≥–µ—Ä–æ–º)
  - [–ö–æ–¥—ã –æ—à–∏–±–æ–∫ –æ–ø–µ—Ä–∞—Ü–∏–π](#–∫–æ–¥—ã-–æ—à–∏–±–æ–∫-–æ–ø–µ—Ä–∞—Ü–∏–π)
  - [–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫](#–æ–±—Ä–∞–±–æ—Ç–∫–∞-–æ—à–∏–±–æ–∫)
- [–°–±–æ—Ä–∫–∞ –ø—Ä–æ–µ–∫—Ç–∞](#—Å–±–æ—Ä–∫–∞-–ø—Ä–æ–µ–∫—Ç–∞)
  - [–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å–µ—Ä–≤–∏—Å–∞ –≤ –∫–æ–¥–µ](#–∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è-—Å–µ—Ä–≤–∏—Å–∞-–≤-–∫–æ–¥–µ)
  - [–ó–∞–ø—É—Å–∫](#–∑–∞–ø—É—Å–∫)
- [–¢–µ—Å—Ç—ã](#—Ç–µ—Å—Ç—ã)
- [–ü–æ—Å–ª–µ–¥–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è](#–ø–æ—Å–ª–µ–¥–Ω–∏–µ-–∏–∑–º–µ–Ω–µ–Ω–∏—è)

## –û–ø–∏—Å–∞–Ω–∏–µ —Å–µ—Ä–≤–∏—Å–∞

**SignatureService**¬†- —ç—Ç–æ —Å–µ—Ä–≤–∏—Å –¥–ª—è —ç–ª–µ–∫—Ç—Ä–æ–Ω–Ω–æ–≥–æ –ø–æ–¥–ø–∏—Å–∞–Ω–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–∞ —Å–æ–≥–ª–∞—à–µ–Ω–∏—è –ø—Ä–æ—Å—Ç–æ–π —ç–ª–µ–∫—Ç—Ä–æ–Ω–Ω–æ–π, –≤–∫–ª—é—á–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—é PDF —Ñ–∞–π–ª–∞ –∏–∑ HTML —à–∞–±–ª–æ–Ω–∞ —Å–æ–≥–ª–∞—à–µ–Ω–∏—è, SMS-–∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é, –≤—ã—á–∏—Å–ª–µ–Ω–∏—è —Ö—ç—à–∞ –º–µ—Ç–æ–¥–∞–Ω–Ω—ã—Ö –ø–æ–¥–ø–∏—Å–∞–Ω–∏—è –∏ –Ω–∞–ª–æ–∂–µ–Ω–∏–µ —Ü–∏—Ñ—Ä–æ–≤–æ–≥–æ —à—Ç–∞–º–ø–∞ –Ω–∞ –¥–æ–∫—É–º–µ–Ω—Ç.

–®–∞–±–ª–æ–Ω —Å–æ–≥–ª–∞—à–µ–Ω–∏—è –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –≤ —Ñ–æ—Ä–º–∞—Ç–µ `agreement_template.html` –∏ —Å–æ–¥–µ—Ä–∂–∞—Ç—å –ø–ª–µ–π—Å—Ö–æ–ª–¥–µ—Ä—ã —Ç–∏–ø–∞ `first_name`, `passport_number`, `phone_number` –∏ —Ç.–¥., —Ç.–µ. —Å–æ–¥–µ—Ä–∂–∞—Ç—å –ø–æ–ª—è –∞–Ω–∞–ª–æ–≥–∏—á–Ω—ã–µ –≤ –ø–µ—Ä–µ–¥–∞–Ω–Ω–æ–º –Ω–∞ –≤—Ö–æ–¥ JSON –∑–∞–ø—Ä–æ—Å—É. –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ, –ø—Ä–∏ –ø–æ–¥–ø–∏—Å–∞–Ω–∏–∏ –¥–æ–∫—É–º–µ–Ω—Ç–∞ –∏–∑ —à–∞–±–ª–æ–Ω–∞ –±—É–¥–µ—Ç —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω PDF —Ñ–∞–π–ª –∏ –≤—Å–µ –ø–ª–µ–π—Å—Ö–æ–ª–¥–µ—Ä—ã –±—É–¥—É—Ç –∑–∞–º–µ–Ω–µ–Ω—ã –Ω–∞ –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ø–µ—Ä–µ–¥–∞–Ω–Ω—ã–µ –≤ JSON –∑–∞–ø—Ä–æ—Å–µ.

![–§—Ä–∞–≥–º–µ–Ω—Ç —à–∞–±–ª–æ–Ω–∞ —Å–æ–≥–ª–∞—à–µ–Ω–∏—è](./images/fragment_agreement_template.PNG)

SMS-–∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –ø—É—Ç–µ–º –æ—Ç–ø—Ä–∞–≤–∫–∏ –∫–æ–¥–∞ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –ø—Ä–∏ –ø–æ–º–æ—â–∏ —Å–µ—Ä–≤–∏—Å–∞ IQSMS –Ω–∞ —É–∫–∞–∑–∞–Ω–Ω—ã–π –Ω–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞. –ö—Ä–µ–¥—ã –¥–ª—è —Å–µ—Ä–≤–∏—Å–∞ —É–∫–∞–∑—ã–≤–∞—é—Ç—Å—è –≤ `application.env`. –¢–µ–∫—Å—Ç —Å–æ–æ–±—â–µ–Ω–∏—è –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ –∑–∞–¥–∞–µ—Ç—Å—è –≤ `message_template.txt`, –≥–¥–µ –ø–ª–µ–π—Å—Ö–æ–ª–¥–µ—Ä `{code}` –±—É–¥–µ—Ç –∑–∞–º–µ–Ω–µ–Ω –Ω–∞ –ø–µ—Ä–µ–¥–∞–Ω–Ω—ã–π –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ –∏–ª–∏ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∫–æ–¥ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è.

–î–∞–ª–µ–µ –≤—ã—á–∏—Å–ª—è–µ—Ç—Å—è —Ö–µ—à —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –º–µ—Ç–æ–¥–∞–Ω–Ω—ã—Ö PDF —Ñ–∞–π–ª–∞, –§–ò–û –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, –Ω–æ–º–µ—Ä–∞ —Ç–µ–ª–µ—Ñ–æ–Ω–∞, –∫–æ–¥–∞ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –∏ –≤—Ä–µ–º–µ–Ω–∏ –ø–æ–¥–ø–∏—Å–∞–Ω–∏—è.

–ù–∞ –ø–æ–ª—É—á–µ–Ω–Ω—ã–π PDF —Ñ–∞–π–ª —Å –¥–∞–Ω–Ω—ã–º–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –Ω–∞–∫–ª–∞–¥—ã–≤–∞–µ—Ç—Å—è —Ü–∏—Ñ—Ä–æ–≤–æ–π —à—Ç–∞–º–ø, —Å–æ–¥–µ—Ä–∂–∞—â–∏–π –≤—Å–µ –¥–∞–Ω–Ω—ã–µ –ø–æ–¥–ø–∏—Å–∞–Ω–∏—è, –≤ —Ç–æ–º —á–∏—Å–ª–µ –≤—ã—á–∏—Å–ª–µ–Ω–Ω—ã–π —Ö–µ—à. –ü—Ä–∏ –ø–µ—Ä–µ–¥–∞—á–∏ –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö, —á–∞—Å—Ç—å –ø–æ–ª–µ–π —è–≤–ª—è—é—Ç—Å—è –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–º–∏ (–§–ò–û, –Ω–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞), —á–∞—Å—Ç—å –ø–æ–ª–µ–π –Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ (–ø–∞—Å–ø–æ—Ä—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ, email), —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ, –≤–∏–¥ —à—Ç–∞–º–ø–∞ –±—É–¥–µ—Ç –æ—Ç–ª–∏—á–∞—Ç—å—Å—è –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –ø–µ—Ä–µ–¥–∞–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö.

![–ü–æ–ª–Ω–∞—è —Ñ–æ—Ä–º–∞ –ø–æ–¥–ø–∏—Å–∞–Ω–∏—è](./images/full_form.PNG)

![–ö—Ä–∞—Ç–∫–∞—è —Ñ–æ—Ä–º–∞ –ø–æ–¥–ø–∏—Å–∞–Ω–∏—è](./images/short_form.PNG)

–û–±—â–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Å–µ—Ä–≤–∏—Å–∞ –∑–∞–¥–∞–µ—Ç—Å—è –≤ `config.ini`.

```text
# –æ—Å–Ω–æ–≤–Ω—ã–µ –ø—É—Ç–∏ –¥–ª—è —Ä–∞–±–æ—Ç—ã
html_template_path=/home/root/bin/agreement_template.html
message_template_path=/home/root/bin/message_template.txt
env_file_path=/home/root/bin/application.env
log_file_path=/home/bin/root/log.txt
temp_dir=/home/root/bin/temp
fonts_path=
output_pdf_dir=/home/root/bin/output
# —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω openssl rand -hex 16
auth_token=AUTH_TOKEN
```

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

### –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:

1. **SignatureService**¬†- –æ—Å–Ω–æ–≤–Ω–æ–π –∫–ª–∞—Å—Å –ø–æ–¥–ø–∏—Å–∞–Ω–∏—è
2. **MessageService**¬†- —Å–µ—Ä–≤–∏—Å –æ—Ç–ø—Ä–∞–≤–∫–∏ –°–ú–°-—Å–æ–æ–±—â–µ–Ω–∏–π —á–µ—Ä–µ–∑ IQSMS
3. **DocumentHasher**¬†- –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏—Ö —Ö–µ—à–µ–π
4. **HtmlTemplateProcessor**¬†- –æ–±—Ä–∞–±–æ—Ç–∫–∞ HTML —à–∞–±–ª–æ–Ω–æ–≤
5. **HtmlToPdfConverter**¬†+ **WkHtmlToPdfWrapper** - –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è HTML –≤ PDF (wkhtmltopdf)
6. **PdfStamper**¬†- –Ω–∞–ª–æ–∂–µ–Ω–∏–µ —Ü–∏—Ñ—Ä–æ–≤—ã—Ö —à—Ç–∞–º–ø–æ–≤ –Ω–∞ PDF (PoDoFo)
7. **LoggerService** - –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–π

### –û—Å–Ω–æ–≤–Ω—ã–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –¥–∞–Ω–Ω—ã—Ö:

```cpp
/// @brief –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Å–µ—Ä–≤–∏—Å–∞ –ø–æ–¥–ø–∏—Å–∞–Ω–∏—è.
struct Config {
    std::string html_template_path;     //< –ü—É—Ç—å –∫ HTML-—à–∞–±–ª–æ–Ω—É —Å–æ–≥–ª–∞—à–µ–Ω–∏—è
    std::string message_template_path;  //< –ü—É—Ç—å –∫ txt-—à–∞–±–ª–æ–Ω—É —Å–æ–æ–±—â–µ–Ω–∏—è
    std::string env_file_path;          //< –ü—É—Ç—å –∫ env-—Ñ–∞–π–ª—É —Å log/pass –¥–ª—è MessageService
    std::string log_file_path;          //< –ü—É—Ç—å –∫ txt-—Ñ–∞–π–ª—É –¥–ª—è –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
    std::string temp_dir;               //< –î–∏—Ä–µ–∫—Ç–æ—Ä–∏—è –¥–ª—è –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤
    std::string fonts_dir;              //< –ü—É—Ç—å –∫ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ —Å–æ —à—Ä–∏—Ñ—Ç–∞–º–∏ –¥–ª—è —Ä–∞–±–æ—Ç—ã PoDoFo (–Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è)
    std::string output_pdf_dir;         //< –î–∏—Ä–µ–∫—Ç–æ—Ä–∏—è –¥–ª—è –ø–æ–¥–ø–∏—Å–∞–Ω–Ω—ã—Ö –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
    std::string auth_token;             //< –¢–æ–∫–µ–Ω –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –≤–∞–ª–∏–¥–Ω–æ—Å—Ç–∏ –∑–∞–ø—Ä–æ—Å–æ–≤
};

/// @brief –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Å–æ–¥–µ—Ä–∂–∏—Ç –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–æ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
struct UserIdentity {
    std::string first_name;                      //< –ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
    std::string middle_name;                     //< –û—Ç—á–µ—Å—Ç–≤–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
    std::string last_name;                       //< –§–∞–º–∏–ª–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
    std::string passport_number;                 //< –ù–æ–º–µ—Ä –ø–∞—Å–ø–æ—Ä—Ç–∞ (6 —Ü–∏—Ñ—Ä)
    std::string passport_series;                 //< –°–µ—Ä–∏—è –ø–∞—Å–ø–æ—Ä—Ç–∞ (4 —Ü–∏—Ñ—Ä—ã)
    std::string passport_issued_by;              //< –ù–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ –æ—Ä–≥–∞–Ω–∞, –≤—ã–¥–∞–≤—à–µ–≥–æ –ø–∞—Å–ø–æ—Ä—Ç
    std::string passport_issued_date;            //< –î–∞—Ç–∞ –≤—ã–¥–∞—á–∏ –≤ —Ñ–æ—Ä–º–∞—Ç–µ "DD.MM.YYYY"
    std::string passport_unite_code;             //< –ö–æ–¥ –ø–æ–¥—Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è –≤ —Ñ–æ—Ä–º–∞—Ç–µ "XXX-XXX"
    std::string passport_birthday_date;          //< –î–∞—Ç–∞ —Ä–æ–∂–¥–µ–Ω–∏—è
    std::string passport_birthday_place;         //< –ú–µ—Å—Ç–æ —Ä–æ–∂–¥–µ–Ω–∏—è
    std::string passport_registration_address;   //< –ê–¥—Ä–µ—Å —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏
    std::string passport_registration_date;      //< –î–∞—Ç–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏
    std::string phone_number;                    //< –ù–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞ –≤ —Ñ–æ—Ä–º–∞—Ç–µ "+7 XXX XXX-XX-XX"
};

/// @brief –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Å–æ–¥–µ—Ä–∂–∏—Ç –¥–∞–Ω–Ω—ã–µ —ç–ª–µ–∫—Ç—Ä–æ–Ω–Ω–æ–π –ø–æ–¥–ø–∏—Å–∏ –¥–æ–∫—É–º–µ–Ω—Ç–∞
struct DocumentSignature {
    std::string confirmation_code;      //< –ö–æ–¥ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –∏–∑ SMS (4 —Ü–∏—Ñ—Ä—ã)
    std::string document_hash;          //< –•—ç—à –¥–æ–∫—É–º–µ–Ω—Ç–∞ –ø–æ –ì–û–°–¢ –†34.11-2012 (64 hex —Å–∏–º–≤–æ–ª–∞)
    std::string signing_time;           //< –í—Ä–µ–º—è –ø–æ–¥–ø–∏—Å–∞–Ω–∏—è –≤ —Ñ–æ—Ä–º–∞—Ç–µ "YYYY-MM-DD HH:MM:SS"
};

/// @brief –ö–æ–º–ø–ª–µ–∫—Å–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –ø–æ–¥–ø–∏—Å–∞–Ω–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–∞
struct SignerData {
    UserIdentity identity;              //< –î–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –¥–ª—è –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
    DocumentSignature signature;        //< –î–∞–Ω–Ω—ã–µ —ç–ª–µ–∫—Ç—Ä–æ–Ω–Ω–æ–π –ø–æ–¥–ø–∏—Å–∏ –¥–æ–∫—É–º–µ–Ω—Ç–∞
};

/// @brief –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Å–æ–¥–µ—Ä–∂–∏—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç —ç—Ç–∞–ø–∞ –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∏ –¥–æ–∫—É–º–µ–Ω—Ç–∞ –∫ –ø–æ–¥–ø–∏—Å–∞–Ω–∏—é
struct DocumentPreparationResult {
    std::string temp_html_path;         //< –ü—É—Ç—å –∫ –≤—Ä–µ–º–µ–Ω–Ω–æ–º—É HTML —Ñ–∞–π–ª—É
    std::string temp_pdf_path;          //< –ü—É—Ç—å –∫ –≤—Ä–µ–º–µ–Ω–Ω–æ–º—É PDF —Ñ–∞–π–ª—É
};

/// @brief –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Å–æ–¥–µ—Ä–∂–∏—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç —ç—Ç–∞–ø–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏—è
struct MessageSendingResult {
    std::string phone_number;           //< –ù–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞, –Ω–∞ –∫–æ—Ç–æ—Ä—ã–π –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ —Å–æ–æ–±—â–µ–Ω–∏–µ
    std::string message_text;           //< –¢–µ–∫—Å –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–Ω–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è
};

/// @brief –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Å–æ–¥–µ—Ä–∂–∏—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç —ç—Ç–∞–ø–∞ –ø–æ–¥–ø–∏—Å–∞–Ω–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–∞
struct DocumentSigningResult {
    std::string first_name;             //< –ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
    std::string middle_name;            //< –û—Ç—á–µ—Å—Ç–≤–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
    std::string last_name;              //< –§–∞–º–∏–ª–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
    std::string phone_number;           //< –ù–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞, –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–Ω—ã–π –¥–ª—è –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è
    std::string confirmation_code;      //< –ö–æ–¥ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è, –≤–≤–µ–¥—ë–Ω–Ω—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º
    std::string signing_time;           //< –í—Ä–µ–º—è –ø–æ–¥–ø–∏—Å–∞–Ω–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–∞ –≤ —Ñ–æ—Ä–º–∞—Ç–µ "DD.MM.YYYY HH:MM:SS"
    std::string document_hash;          //< –ö—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏–π —Ö–µ—à –ø–æ–¥–ø–∏—Å–∞–Ω–Ω–æ–≥–æ –¥–æ–∫—É–º–µ–Ω—Ç–∞
    std::string signed_pdf_path;        //< –ü—É—Ç—å –∫ –∏—Ç–æ–≥–æ–≤–æ–º—É PDF —Ñ–∞–π–ª—É —Å –ø–æ–¥–ø–∏—Å—å—é
};

/// @brief Type-safe –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –¥–ª—è –æ–ø–µ—Ä–∞—Ü–∏–π, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–≥—É—Ç –∑–∞–≤–µ—Ä—à–∏—Ç—å—Å—è —Å –æ—à–∏–±–∫–æ–π
template<typename T = void>
class Result {
    // –û—Å—Ç–∞–ª—å–Ω–æ–π –∫–æ–¥
}
```

### **–ú–µ—Ç–æ–¥—ã –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏**

–î–∞–Ω–Ω—ã–µ –¥–ª—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –ø—Ä–æ–ø–∏—Å—ã–≤–∞—é—Ç—Å—è –≤ —Ñ–∞–π–ª—É config.ini –∏ –ø–æ–¥—Ç—è–≥–∏–≤–∞—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏

```text
# –æ—Å–Ω–æ–≤–Ω—ã–µ –ø—É—Ç–∏ –¥–ª—è —Ä–∞–±–æ—Ç—ã
html_template_path=/home/root/bin/agreement_template.html
message_template_path=/home/root/bin/message_template.txt
env_file_path=/home/root/bin/application.env
log_file_path=/home/bin/root/log.txt
temp_dir=/home/root/bin/temp
fonts_path=
output_pdf_dir=/home/root/bin/output
# —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω openssl rand -hex 16
auth_token=AUTH_TOKEN
```
–Ω–æ —Ç–∞–∫–∂–µ –º–æ–∂–Ω–æ –≤—Ä—É—á–Ω—É—é –ø–æ—Ç–æ–∫–æ–±–µ–∑–æ–ø–∞—Å–Ω–æ –∑–∞–¥–∞—Ç—å –ª–æ–≥–∏–Ω/–ø–∞—Ä–æ–ª—å –¥–ª—è MessageService —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–º —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º –≤ application.env —Å –ø–æ–º–æ—â—å—é –º–µ—Ç–æ–¥–∞ `bool setMessageServiceCreds(const std::string& login, const std::string& password)`.

–î—Ä—É–≥–∏–µ –º–µ—Ç–æ–¥—ã –ø–æ —Ä–∞–±–æ—Ç–µ —Å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–µ–π —Å–µ—Ä–≤–∏—Å–∞:
- `Config getConfig()` ‚Äî –ø–æ—Ç–æ–∫–æ–±–µ–∑–æ–ø–∞—Å–Ω–æ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ç–µ–∫—É—â—É—é –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é —Å–µ—Ä–≤–∏—Å–∞;
- `void updateConfig(const Config& new_config)` ‚Äî –ø–æ—Ç–æ–∫–æ–±–µ–∑–æ–ø–∞—Å–Ω–æ –æ–±–Ω–æ–≤–ª—è–µ—Ç –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é.

### **–û—Å–Ω–æ–≤–Ω—ã–µ –º–µ—Ç–æ–¥—ã**

- `SignatureService(const std::string& config_path)` ‚Äî —Å–æ–∑–¥–∞—ë—Ç —Å–µ—Ä–≤–∏—Å —Å —É–∫–∞–∑–∞–Ω–Ω—ã–º –ø—É—Ç–µ–º –∫ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω–æ–º—É —Ñ–∞–π–ª—É.
- `SignatureService(const Config& config)` ‚Äî —Å–æ–∑–¥–∞—ë—Ç —Å–µ—Ä–≤–∏—Å —Å –≥–æ—Ç–æ–≤—ã–º –æ–±—ä–µ–∫—Ç–æ–º –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏.
- `Result<std::string> generateConfirmationCode(const std::string& auth_token, int length = 4)` ‚Äî –ø–æ—Ç–æ–∫–æ–±–µ–∑–æ–ø–∞—Å–Ω–æ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç —Å–ª—É—á–∞–π–Ω—ã–π –∫–æ–¥ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è —É–∫–∞–∑–∞–Ω–Ω–æ–π –¥–ª–∏–Ω—ã —Å –ø—Ä–æ–≤–µ—Ä–∫–æ–π –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏.
- `Result<DocumentSigningResult> signDocument(const std::string& auth_token, bool test_mode, bool need_all_user_data_fields, const UserIdentity& user_identity, const std::string& confirmation_code)` ‚Äî –ø–æ—Ç–æ–∫–æ–±–µ–∑–æ–ø–∞—Å–Ω–æ –ø–æ–¥–ø–∏—Å—ã–≤–∞–µ—Ç –¥–æ–∫—É–º–µ–Ω—Ç —Å –ø—Ä–æ–≤–µ—Ä–∫–æ–π –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏, –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç —Ç–µ—Å—Ç–æ–≤—ã–π —Ä–µ–∂–∏–º –∏ —Ä–∞–∑–ª–∏—á–Ω—ã–µ —É—Ä–æ–≤–Ω–∏ –ø—Ä–æ–≤–µ—Ä–∫–∏ –¥–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.
- `Result<ProviderSendingResult> sendMessageViaIqSms(const std::string& auth_token, bool test_mode, const std::string& phone_number, const std::string& message_text)` ‚Äî –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç SMS —Å–æ–æ–±—â–µ–Ω–∏–µ —á–µ—Ä–µ–∑ –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞ IQSMS —Å –ø—Ä–æ–≤–µ—Ä–∫–æ–π –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –∏ –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π —Ç–µ—Å—Ç–æ–≤–æ–≥–æ —Ä–µ–∂–∏–º–∞.
- `Result<bool> setMessageServiceCreds(const std::string& auth_token, const std::string& login, const std::string& password)` ‚Äî –ø–æ—Ç–æ–∫–æ–±–µ–∑–æ–ø–∞—Å–Ω–æ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –Ω–æ–≤—ã–µ —É—á–µ—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –¥–ª—è SMS —Å–µ—Ä–≤–∏—Å–∞ —Å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º –≤ —Ñ–∞–π–ª –∏ –ø—Ä–æ–≤–µ—Ä–∫–æ–π –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏.
- `Result<> updateConfig(const std::string& auth_token, const Config& new_config)` ‚Äî –ø–æ—Ç–æ–∫–æ–±–µ–∑–æ–ø–∞—Å–Ω–æ –æ–±–Ω–æ–≤–ª—è–µ—Ç –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é —Å–µ—Ä–≤–∏—Å–∞ —Å –ø—Ä–æ–≤–µ—Ä–∫–æ–π –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏.

- –ú–µ—Ç–æ–¥—ã –∫–ª–∞—Å—Å–∞ `Result<T>`
  - `success()` ‚Äî —Å–æ–∑–¥–∞—Ç—å —É—Å–ø–µ—à–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç (–±–µ–∑ –∑–Ω–∞—á–µ–Ω–∏—è –¥–ª—è `void`, —Å –¥–∞–Ω–Ω—ã–º–∏ –¥–ª—è `T`).  
  - `error(code, message)` ‚Äî —Å–æ–∑–¥–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç —Å –æ—à–∏–±–∫–æ–π.  
  - `isSuccess()` ‚Äî –ø—Ä–æ–≤–µ—Ä–∫–∞ —É—Å–ø–µ—à–Ω–æ—Å—Ç–∏ –æ–ø–µ—Ä–∞—Ü–∏–∏.  
  - `isError()` ‚Äî –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è –æ—à–∏–±–∫–∏.  
  - `getValue()` ‚Äî –ø–æ–ª—É—á–∏—Ç—å –∑–Ω–∞—á–µ–Ω–∏–µ (–µ—Å–ª–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç —É—Å–ø–µ—à–Ω—ã–π).  
  - `getErrorCode()` ‚Äî –ø–æ–ª—É—á–∏—Ç—å –∫–æ–¥ –æ—à–∏–±–∫–∏.  
  - `getErrorMessage()` ‚Äî –ø–æ–ª—É—á–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ—à–∏–±–∫–µ.  

### –†–∞–±–æ—Ç–∞ —Å JSON –¥–∞–Ω–Ω—ã–º–∏

–î–ª—è —Ä–∞–±–æ—Ç—ã —Å JSON –≤–∏–¥–∞:
```json
{   
    "auth_token": "AUTH_TOKEN",
    "is_test": 1,
    "first_name": "–ò–≤–∞–Ω",
    "middle_name": "–ò–≤–∞–Ω–æ–≤–∏—á", 
    "last_name": "–ò–≤–∞–Ω–æ–≤",
    "passport_number": "123456",
    "passport_series": "1234",
    "passport_issued_by": "–£–ú–í–î –ø–æ –≥. –ú–æ—Å–∫–≤–µ",
    "passport_issued_date": "12.06.2015",
    "passport_unite_code": "123-456",
    "passport_birthday_date": "15.03.1990",
    "passport_birthday_place": "–≥. –ú–æ—Å–∫–≤–∞",
    "passport_registration_address": "–≥. –ú–æ—Å–∫–≤–∞, —É–ª. –õ–µ–Ω–∏–Ω–∞, –¥. 1",
    "passport_registration_date": "20.06.2015",
    "email": "Ivanov1990@mail.ru",
    "phone_number": "+79123456789",
    "confirmation_code": "12345"
}
```
–ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω—ã —Ñ—É–Ω–∫—Ü–∏–∏:
- `UserIdentity parsers::parseJsonStringToUserIdentity(const std::string& json_string)` - –ø–∞—Ä—Å–∏—Ç JSON —Å—Ç—Ä–æ–∫—É –≤ —Å—Ç—Ä—É–∫—Ç—É—Ä—É UserIdentity;
- `std::string parsers::parseUserIdentityToJsonString(const UserIdentity& user, bool pretty = true)` - –ø–∞—Ä—Å–∏—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä—É UserIdentity –≤ JSON —Å—Ç—Ä–æ–∫—É.

### –†–∞–±–æ—Ç–∞ —Å –ª–æ–≥–≥–µ—Ä–æ–º

–ó–∞–ø–∏—Å–∏ –≤ –ª–æ–≥ —Ñ–∞–π–ª–µ –≤—ã–≥–ª—è–¥—è—Ç —Å–ª–µ–¥—É—é—â–∏–º –æ–±—Ä–∞–∑–æ–º:
```text
[2025-10-14T12:29:02+03:00] [INFO] [Thread:132746208360384] SignatureService: logger was started
[2025-10-14T12:29:02+03:00] [INFO] [Thread:132746208360384] SignatureService: preparing document for signing
[2025-10-14T12:29:02+03:00] [INFO] [Thread:132746208360384] SignatureService: document prepared successfully
[2025-10-14T12:29:03+03:00] [INFO] [Thread:132746208360384] SignatureService: sending SMS to: +79*********
[2025-10-14T12:29:03+03:00] [INFO] [Thread:132746208360384] SignatureService: Responcse from IQSMS: accepted;6776285131
[2025-10-14T12:29:04+03:00] [INFO] [Thread:132746208360384] SignatureService: SMS status from IQSMS: 6776285131;queued
[2025-10-14T12:29:04+03:00] [INFO] [Thread:132746208360384] SignatureService: creating PDF stamp
[2025-10-14T12:29:04+03:00] [SUCCESS] [Thread:132746208360384] SignatureService: document signed successfully for: +79*********
```
–ú–µ—Ç–æ–¥—ã `LoggerService`, –∏—Å–ø–æ–ª—å–∑—É—é—â–∏–µ—Å—è –¥–ª—è –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è:
```cpp
/// @brief –ó–∞–ø–∏—Å–∞—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
void logInfo(const std::string& message);

/// @brief –ó–∞–ø–∏—Å–∞—Ç—å –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ
void logWarning(const std::string& message);

/// @brief –ó–∞–ø–∏—Å–∞—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ—à–∏–±–∫–µ
void logError(const std::string& message);

/// @brief –ó–∞–ø–∏—Å–∞—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ –æ–± —É—Å–ø–µ—Ö–µ
void logSuccess(const std::string& message);
```

### –ö–æ–¥—ã –æ—à–∏–±–æ–∫ –æ–ø–µ—Ä–∞—Ü–∏–π:

```cpp
/// @brief –ö–æ–¥—ã –æ—à–∏–±–æ–∫ –æ–ø–µ—Ä–∞—Ü–∏–π —Å–µ—Ä–≤–∏—Å–∞
enum class ErrorCode {
    SUCCESS,                            //< –û–ø–µ—Ä–∞—Ü–∏—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∞ —É—Å–ø–µ—à–Ω–æ
    INIT_SERVICE_ERROR,                 //< –û—à–∏–±–∫–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ —Å–µ—Ä–≤–∏—Å–∞
    INVALID_USER_DATA,                  //< –û—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è –≤ USER DATA
    INVALID_JSON,                       //< –ù–µ–≤–∞–ª–∏–¥–Ω—ã–π JSON —Ñ–æ—Ä–º–∞—Ç
    INVALID_AUTH_TOKEN,                 //< –ù–µ–≤–∞–ª–∏–¥–Ω—ã–π —Ç–æ–∫–µ–Ω –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
    FILE_IO_ERROR,                      //< –û—à–∏–±–∫–∞ —á—Ç–µ–Ω–∏—è/–∑–∞–ø–∏—Å–∏ —Ñ–∞–π–ª–∞
    HTML_REPLACE_ERROR,                 //< –û—à–∏–±–∫–∞ –∑–∞–º–µ–Ω—ã –ø–ª–µ–π—Å—Ö–æ–ª–¥–µ—Ä–æ–≤ –≤ HTML —à–∞–±–ª–æ–Ω–µ
    PDF_GENERATION_ERROR,               //< –û—à–∏–±–∫–∞ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ PDF –∏–∑ HTML —à–∞–±–ª–æ–Ω–∞
    SMS_SEND_ERROR,                     //< –û—à–∏–±–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ SMS —Å–æ–æ–±—â–µ–Ω–∏—è
    AUTHENTICATION_FAILED,              //< –ù–µ–≤–µ—Ä–Ω—ã–π –∫–æ–¥ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –∏–ª–∏ –æ—à–∏–±–∫–∞ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
    STAMP_APPLICATION_ERROR,            //< –û—à–∏–±–∫–∞ –Ω–∞–ª–æ–∂–µ–Ω–∏—è —à—Ç–∞–º–ø–∞ –Ω–∞ –¥–æ–∫—É–º–µ–Ω—Ç
    INVALID_CONFIG,                     //< –ù–µ–≤–∞–ª–∏–¥–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Å–µ—Ä–≤–∏—Å–∞
    CREDENTIALS_ERROR,                  //< –ù–µ–≤–∞–ª–∏–¥–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Å–µ—Ä–≤–∏—Å–∞ MessageService
    SERVICE_SHUTDOWN,                   //< –°–µ—Ä–≤–∏—Å –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –∏ –Ω–µ –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –Ω–æ–≤—ã–µ –∑–∞–¥–∞—á–∏
    UNKNOWN_ERROR                       //< –ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –æ—à–∏–±–∫–∞
};
```

### –û–±—Ä–∞–±–æ—Ç–∫–∞ –±—Ä–∞–±–æ—Ç–∫–∏ –æ—à–∏–±–æ–∫:

```cpp
auto result = service.signDocument(...);

if (!result.IsSuccess()) {
    switch (result.error_code) {
        case SignatureService::ErrorCode::INVALID_JSON:
            // –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–∫–∏ JSON
            break;
        case SignatureService::ErrorCode::SMS_SEND_ERROR:
            // –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–∫–∏ SMS
            break;
        // ... –¥—Ä—É–≥–∏–µ –∫–æ–¥—ã –æ—à–∏–±–æ–∫
        default:
            // –û–±—Ä–∞–±–æ—Ç–∫–∞ –Ω–µ–∏–∑–≤–µ—Å—Ç–Ω–æ–π –æ—à–∏–±–∫–∏
    }
}
```

## **–°–±–æ—Ä–∫–∞ –ø—Ä–æ–µ–∫—Ç–∞**

```bash
# –ü–µ—Ä–≤–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞
cmake -B build -DCMAKE_BUILD_TYPE=Release

# –°–±–æ—Ä–∫–∞ (–æ—Å–Ω–æ–≤–Ω–∞—è –∫–æ–º–∞–Ω–¥–∞)
cmake --build build --parallel

# –¢–æ–ª—å–∫–æ –ø–µ—Ä–µ—Å–±–æ—Ä–∫–∞ –∏–∑–º–µ–Ω–µ–Ω–∏–π
cmake --build build --parallel

# –û—á–∏—Å—Ç–∫–∞ –∏ –ø–æ–ª–Ω–∞—è –ø–µ—Ä–µ—Å–±–æ—Ä–∫–∞
cmake --build build --clean-first --parallel
```

–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ `resoures` –≤ `bin`

### –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å–µ—Ä–≤–∏—Å–∞ –≤ –∫–æ–¥–µ
```cpp
auto& converter = WkHtmlToPdfWrapper::getInstance(); // <- —Å–æ–∑–¥–∞–Ω–∏–µ –∫–æ–Ω–≤–µ—Ä—Ç–æ—Ä–∞
if (!converter.initialize()) {         // <- –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–∞—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∫–æ–Ω–≤–µ—Ä—Ç–æ—Ä–∞ –≤ –≥–ª–∞–≤–Ω–æ–º –ø–æ—Ç–æ–∫–µ
    std::cerr << "Failed to initialize PDF converter" << std::endl;
}
SignatureService signer(config_file);

// –û—Å—Ç–∞–ª—å–Ω–æ–π –∫–æ–¥ ...

converter.shutdown(true);             // <- –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–∞—è –¥–µ–∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∫–æ–Ω–≤–µ—Ä—Ç–æ—Ä–∞ –≤ —Ç–æ–º –∂–µ –ø–æ—Ç–æ–∫–µ
```

### **–ó–∞–ø—É—Å–∫**
```bash
./DocumentSigner ./config.ini ./data.json
```

## –¢–µ—Å—Ç—ã

–¢–µ—Å—Ç 8 –ø–æ—Ç–æ–∫–æ–≤ –ø–æ 50 –æ–ø–µ—Ä–∞—Ü–∏–π 

```bash
user@DESKTOP-GL364V5:~/cpp_files/document_signer_ver_1.3/bin $ ./DocumentSigner 
Running large-scale concurrency tests...
=== üöÄ Starting Large-Scale Concurrency Tests ===
Testing with 400 operations across multiple threads...

--- üìù Test 1: Full Signing Cycle (400 operations) ---
‚úì Thread 2: 10 successful operations
‚úì Thread 3: 20 successful operations
‚úì Thread 6: 30 successful operations
‚úì Thread 7: 40 successful operations
‚úì Thread 2: 50 successful operations
‚úì Thread 3: 60 successful operations
‚úì Thread 6: 70 successful operations
‚úì Thread 7: 80 successful operations
‚úì Thread 2: 90 successful operations
‚úì Thread 3: 100 successful operations
‚úì Thread 6: 110 successful operations
‚úì Thread 7: 120 successful operations
‚úì Thread 2: 130 successful operations
‚úì Thread 3: 140 successful operations
‚úì Thread 6: 150 successful operations
‚úì Thread 7: 160 successful operations
‚úì Thread 2: 170 successful operations
‚úì Thread 3: 180 successful operations
‚úì Thread 6: 190 successful operations
‚úì Thread 7: 200 successful operations
‚úì Thread 2: 210 successful operations
‚úì Thread 3: 220 successful operations
‚úì Thread 6: 230 successful operations
‚úì Thread 7: 240 successful operations
‚úì Thread 2: 250 successful operations
‚úì Thread 3: 260 successful operations
‚úì Thread 6: 270 successful operations
‚úì Thread 7: 280 successful operations
‚úì Thread 2: 290 successful operations
‚úì Thread 3: 300 successful operations
‚úì Thread 6: 310 successful operations
‚úì Thread 7: 320 successful operations
‚úì Thread 2: 330 successful operations
‚úì Thread 3: 340 successful operations
‚úì Thread 6: 350 successful operations
‚úì Thread 7: 360 successful operations
‚úì Thread 2: 370 successful operations
‚úì Thread 3: 380 successful operations
‚úì Thread 6: 390 successful operations
‚úì Thread 7: 400 successful operations

=== üìä Test Results ===
Total time: 143886 ms
Total operations: 400
Successful: 400
Failed: 0
Exceptions: 0
Success rate: 100.00%
Operations per second: 2.78

‚úÖ SUCCESS: All tests passed successfully!

=== üéØ Concurrency Testing Complete ===
```

## **–ü–æ—Å–ª–µ–¥–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è**

### **–ü–µ—Ä–µ—Ä–∞–±–æ—Ç–∞–Ω—ã –æ—Å–Ω–æ–≤–Ω—ã–µ –º–µ—Ç–æ–¥—ã –ø–æ–¥–ø–∏—Å–∞–Ω–∏—è –≤ SignatureService**

- –î–æ–±–∞–≤–ª–µ–Ω—ã —Ç–µ—Å—Ç–æ–≤—ã–π —Ä–µ–∂–∏–º –ø–æ–¥–ø–∏—Å–∞–Ω–∏—è, –ø—Ä–∏ –∫–æ—Ç–æ—Ä–æ–º –Ω–µ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –æ—Ç–ø—Ä–∞–≤–∫–∞ –°–ú–°-—Å–æ–æ–±—â–µ–Ω–∏—è.
- –î–æ–±–∞–≤–ª–µ–Ω —Ç–æ–∫–µ–Ω –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –∑–∞–ø—Ä–æ—Å–æ–≤, —Ñ—É–Ω–∫—Ü–∏—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ç–æ–∫–µ–Ω–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–∏, –ø–æ–ª–µ auth_token –≤ —Ñ–∞–π–ª–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏.
- –î–æ–±–∞–≤–ª–µ–Ω—ã —Ñ—É–Ω–∫—Ü–∏–∏ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –¥–ª—è —Å—Ç—Ä—É–∫—Ç—É—Ä UserIdentity, –∫–æ—Ç–æ—Ä—ã–µ —Å–æ–¥–µ—Ä–∂–∞—Ç –ø–æ–ª–Ω—É—é –∏–ª–∏ –∫—Ä–∞—Ç–∫–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π.
- –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–Ω–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è.

### **–î–æ–±–∞–≤–ª–µ–Ω—ã –Ω–æ–≤—ã–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –≤ MessageService**

- –î–æ–±–∞–≤–ª–µ–Ω–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ `ProviderSendingResult` - —Ä–µ–∑—É–ª—å—Ç–∞—Ç –∑–∞–ø—Ä–æ—Å–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏—è.
- –î–æ–±–∞–≤–ª–µ–Ω–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ `ProviderBalanceResult` - —Ä–µ–∑—É–ª—å—Ç–∞—Ç –∑–∞–ø—Ä–æ—Å–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏ –±–∞–ª–∞–Ω—Å–∞.
- –î–æ–±–∞–≤–ª–µ–Ω –º–µ—Ç–æ–¥ –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å—Ç–∞—Ç—É—Å–∞ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–Ω–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è.

### **–î–æ–±–∞–≤–ª–µ–Ω–∞ –ø–æ–¥–¥–µ—Ä–∂–∫–∞ –º–Ω–æ–≥–æ–ø–æ—Ç–æ—á–Ω–æ—Å—Ç–∏ –≤ SignatureService**

1. –ú–µ—Ç–æ–¥—ã –∫–ª–∞—Å—Å–∞ `SignatureService` —Ç–µ–ø–µ—Ä—å –ø–æ—Ç–æ–∫–æ–±–µ–∑–æ–ø–∞—Å–Ω—ã:
    - –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `std::mutex` –¥–ª—è –∑–∞—â–∏—Ç—ã –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –∏ –¥–æ—Å—Ç—É–ø–∞ –∫ –ø–æ–¥—Å–µ—Ä–≤–∏—Å–∞–º.
    - –ú–æ–∂–Ω–æ –±–µ–∑–æ–ø–∞—Å–Ω–æ —Å–æ–≤–µ—Ä—à–∞—Ç—å –ø–æ–ª–Ω—ã–π —Ü–∏–∫–ª –ø–æ–¥–ø–∏—Å–∞–Ω–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–∞ `prepareDocumentForSigning()`->`generateCodeAndSendMessage()`->`signDocument()` –∏–∑ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –ø–æ—Ç–æ–∫–æ–≤ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ.

2. –î–æ–±–∞–≤–ª–µ–Ω –Ω–æ–≤—ã–π –∫–ª–∞—Å—Å `WkHtmlToPdfWrapper` - singleton-–∫–ª–∞—Å—Å-–æ–±—ë—Ä—Ç–∫–∞ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –±–∏–±–ª–∏–æ—Ç–µ–∫–æ–π wkhtmltopdf –≤ –ø–æ—Ç–æ–∫–æ–±–µ–∑–æ–ø–∞—Å–Ω–æ–º —Ä–µ–∂–∏–º–µ, –ø–æ—Å–∫–æ–ª—å–∫—É –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –º–Ω–æ–≥–æ–ø–æ—Ç–æ—á–Ω–æ—Å—Ç—å –¥–∞–∂–µ —Å —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–µ–π, —Ç–æ –µ—Å—Ç—å –≤—Å–µ –≤—ã–∑–æ–≤—ã –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏ HTML ‚Üí PDF –¥–æ–ª–∂–Ω—ã –≤—ã–ø–æ–ª–Ω—è—Ç—å—Å—è –≤ –æ–¥–Ω–æ–º –ø–æ—Ç–æ–∫–µ.
`WkHtmlToPdfWrapper` —Ä–µ—à–∞–µ—Ç —ç—Ç—É –ø—Ä–æ–±–ª–µ–º—É, –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è—è:
- –û–¥–∏–Ω —Ä–∞–±–æ—á–∏–π –ø–æ—Ç–æ–∫ –¥–ª—è –≤—Å–µ—Ö –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–π
- –û—á–µ—Ä–µ–¥—å –∑–∞–¥–∞—á, –∫—É–¥–∞ –º–æ–≥—É—Ç –¥–æ–±–∞–≤–ª—è—Ç—å –∑–∞–¥–∞—á–∏ –Ω–µ—Å–∫–æ–ª—å–∫–æ –ø–æ—Ç–æ–∫–æ–≤ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ
- –ü–æ–¥–¥–µ—Ä–∂–∫—É —Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–≥–æ –∏ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–≥–æ API

### **–í—ã–¥–µ–ª–µ–Ω–∏–µ —Ä–∞–±–æ—Ç—ã —Å —Ñ–∞–π–ª–∞–º–∏**

- –§—É–Ω–∫—Ü–∏–∏ –ø–æ —Ä–∞–±–æ—Ç–µ —Å –≤—Ä–µ–º–µ–Ω–Ω—ã–º–∏ —Ñ–∞–π–ª–∞–º–∏ –≤—ã–Ω–µ—Å–µ–Ω—ã –∏–∑ `SignatureService` –≤ –æ—Ç–¥–µ–ª—å–Ω—ã–π namespace `file_utils`.
- –î–æ–±–∞–≤–ª–µ–Ω—ã —Ñ—É–Ω–∫—Ü–∏–∏:
    - `createTempCopyWithUniqueFilename()` ‚Äî —Å–æ–∑–¥–∞—ë—Ç –≤—Ä–µ–º–µ–Ω–Ω—É—é –∫–æ–ø–∏—é —Ñ–∞–π–ª–∞ —Å —É–Ω–∏–∫–∞–ª—å–Ω—ã–º –∏–º–µ–Ω–µ–º.
    - `generateUniqueFilename()` ‚Äî –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ –∏–º–µ–Ω–∞ —Å —É—á—ë—Ç–æ–º –≤—Ä–µ–º–µ–Ω–∏, –ø–æ—Ç–æ–∫–∞, —Å—á—ë—Ç—á–∏–∫–∞ –∏ —Å–ª—É—á–∞–π–Ω–æ–≥–æ —á–∏—Å–ª–∞.
    - `cleanupTempFiles()` ‚Äî –±–µ–∑–æ–ø–∞—Å–Ω–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤.
    - `fileExists()` –∏ `ensureDirectoryExists()` ‚Äî –ø—Ä–æ–≤–µ—Ä–∫–∏ –∏ —Å–æ–∑–¥–∞–Ω–∏–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–π.
        
- –í—Å–µ —Ñ—É–Ω–∫—Ü–∏–∏ –ø–æ—Ç–æ–∫–æ–±–µ–∑–æ–ø–∞—Å–Ω—ã, –∏—Å–ø–æ–ª—å–∑—É—é—Ç –º—å—é—Ç–µ–∫—Å –¥–ª—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ —Ñ–∞–π–ª–æ–≤–æ–π —Å–∏—Å—Ç–µ–º—ã.

### **–ó–∞–º–µ–Ω–∞ TimeUtils**

- –ö–ª–∞—Å—Å `TimeUtils` –∑–∞–º–µ–Ω—ë–Ω –Ω–∞ namespace `time_utils` –¥–ª—è —É–ø—Ä–æ—â–µ–Ω–∏—è —Ä–∞–±–æ—Ç—ã —Å –≤—Ä–µ–º–µ–Ω–µ–º –∏ —Å–∏–Ω—Ç–∞–∫—Å–∏—Å–∞.

### **–ü—Ä–æ—á–∏–µ —É–ª—É—á—à–µ–Ω–∏—è**

- –£–±—Ä–∞–Ω—ã –ø—Ä—è–º—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –Ω–∞ —Ñ–∞–π–ª–æ–≤—É—é —Å–∏—Å—Ç–µ–º—É –∏–∑ `SignatureService`, –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ `temp` –∏ `output` —Å–æ–∑–¥–∞—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏ –≤—ã–∑–æ–≤–µ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä–∞ –∫–ª–∞—Å—Å.